<html>
    <head>
        <title>Log In</title>
        <script src='https://cdn.firebase.com/js/client/2.0.4/firebase.js'></script>
        <script src='https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js'></script>
        <script src='https://code.jquery.com/ui/1.11.4/jquery-ui.min.js'></script>
        <link rel="stylesheet" href="styles/jquery-ui.css">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="stylesheet" href="styles/index.css" type="text/css">
        
        <style>
		.dlg-no-close .ui-dialog-titlebar-close {
			display: none;
		}
        </style>
        </head>
    
    <body>
        <div id="dialogEmail" title="Reset Successful">Password reset email sent.</div>
        <div id="dialogEmailErr" title="Error">Error sending password reset email.</div>
        
        <div class="page-header container text-center">
            <h1>International Alert Security App</h1>
        </div>
        <div class="container text-center">
            <h3>Forgot Password</h3>
        </div>
        <div id="container" class="info">
            <p>Email Address
            <input class="email" type="email" id="name" placeholder="Enter your email">
            </p>
            <button onClick="passReset()" class="forgotpass">Send Password Reset</button>
            <br>
        </div>
        <form name="back" action="index.html">
            <input class="backbutton" type="submit" value="Back">
        </form>
        
        <!-- ==================== SCRIPTS ==================== -->
        <script>
            ////////// DIALOG \\\\\\\\\\
            $(function() {
                $( "#dialogEmail" ).dialog({
                    autoOpen: false,
                    modal: true,
                    dialogClass: "dlg-no-close",
                    buttons: {
                        "OK": function() {
                            $( this ).dialog( "close" );
                        }
                    }
                });
            });
            
            $(function() {
                $( "#dialogEmailErr" ).dialog({
                    autoOpen: false,
                    modal: true,
                    dialogClass: "dlg-no-close",
                    buttons: {
                        "OK": function() {
                            $( this ).dialog( "close" );
                        }
                    }
                });
            });
            
            
            ////////// MAIN SCRIPTS \\\\\\\\\\
            
            function passReset() {
                username = document.getElementById("name").value;
                var ref = new Firebase("https://crackling-fire-1447.firebaseio.com/contacts");
                ref.resetPassword({
                    email : username
                }, function(error) {
                    if (error === null) {
                        $( "#dialogEmail" ).dialog( "open" );
                        //alert("Password reset email sent");
                        setTimeout(function(){window.location = "index.html";},500);
                    } else {
                        $( "#dialogEmailErr" ).dialog( "open" );
                        //alert("Error sending password reset email");
                    }
                });
            }
        </script>
        <!-- ================================================= -->
    </body>
</html>